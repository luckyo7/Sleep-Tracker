// handle noise model and related calculations